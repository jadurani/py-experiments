import obspy
import numpy as np

'''
TRIGGERED
2023-05-17 02:37:15 [Processor] Max PGA Values (Acceleration (m/s$^2$))
{
    "ENE": 0.011891705588669957,
    "ENN": 5657.48357826317,
    "ENZ": 5657.480782259755
}
2023-05-17 02:37:15 [Processor] Signal deconvolution set to DISP
2023-05-17 02:37:15 [Processor] Alert stream units are displacement (m)
2023-05-17 02:37:15 [Processor] Deconv Channel: DISP     Units: Displacement (m)
2023-05-17 02:37:15 [Processor] Max PGD Values (Displacement (m))
{
    "ENE": 4.06369070205492e-05,
    "ENN": 55.20254009397969,
    "ENZ": 55.2025469241524
}
{
    "floor_num": 8,
    "event_time": "2023-05-17T02:37:15.30Z",
    "axis_with_max_drift": "z",
    "acceleration": {
        "x": 0.011891705588669957,
        "y": 5657.48357826317,
        "z": 5657.480782259755
    },
    "displacement": {
        "x": 4.06369070205492e-05,
        "y": 55.20254009397969,
        "z": 55.2025469241524
    },
    "intensity": {
        "x": "I",
        "y": "X+",
        "z": "X+"
    },
    "drift": {
        "x": 0.0020318453510274597,
        "y": 2760.1270046989844,
        "z": 2760.12734620762
    },
    "over_drift_thresh": {
        "x": false,
        "y": true,
        "z": true
    }
}
'''

# AM.R05CB.00.ENE | 2023-05-17T04:57:38.783000Z - 2023-05-17T04:57:44.533000Z | 100.0 Hz, 576 samples (masked)
ene_str = '''2.32526151e-04  -2.87165380e-04   2.30276014e-04  -2.88297714e-04
   2.29511275e-04  -2.90655613e-04   2.28408114e-04  -2.92686141e-04
   2.27734674e-04  -2.96149049e-04   2.28159623e-04  -2.99080773e-04
   2.27627677e-04  -3.01955570e-04   2.27118217e-04  -3.05121736e-04
   2.26019071e-04  -3.06766563e-04   2.23934060e-04  -3.08858893e-04
   2.22520551e-04  -3.10220736e-04   2.20255217e-04  -3.10893230e-04
   2.18402083e-04  -3.13019832e-04   2.17575698e-04  -3.14948645e-04
   2.16013499e-04  -3.17258268e-04   2.16467296e-04  -3.20507663e-04
   2.16669929e-04  -3.22766157e-04   2.16534940e-04  -3.25766626e-04
   2.17125368e-04  -3.27742706e-04   2.16000662e-04  -3.28408809e-04
   2.15904437e-04  -3.29654598e-04   2.14901480e-04  -3.28975099e-04
   2.13848460e-04  -3.29079240e-04   2.14090764e-04  -3.29467703e-04
   2.14174129e-04  -3.28996263e-04   2.15646982e-04  -3.30467427e-04
   2.18035376e-04  -3.30847328e-04   2.20014308e-04  -3.31187939e-04
   2.23385247e-04  -3.31676346e-04   2.25693904e-04  -3.30087281e-04
   2.28011973e-04  -3.28743276e-04   2.30673879e-04  -3.26014892e-04
   2.32046639e-04  -3.22760629e-04   2.34957901e-04  -3.19932551e-04
   2.38281647e-04  -3.15825095e-04   2.42007024e-04  -3.13010760e-04
   2.47486613e-04  -3.10451485e-04   2.52982943e-04  -3.07124521e-04
   2.59374419e-04  -3.04358500e-04   2.66599660e-04  -2.99911511e-04
   2.72336167e-04  -2.95314414e-04   2.79140472e-04  -2.89966612e-04
   2.84709653e-04  -2.82765624e-04   2.90448342e-04  -2.76322290e-04
   2.97324592e-04  -2.68963456e-04   3.03769882e-04  -2.61718002e-04
   3.12014187e-04  -2.55998130e-04   3.20500761e-04  -2.49040361e-04
   3.29646389e-04  -2.43347858e-04   3.40045807e-04  -2.37413848e-04
   3.48994083e-04  -2.29714602e-04   3.58749117e-04  -2.23045988e-04
   3.67671579e-04  -2.13839798e-04   3.75367925e-04  -2.05031174e-04
   3.84000139e-04  -1.96737470e-04   3.91526543e-04  -1.87413270e-04
   3.99817045e-04  -1.79760791e-04   4.09708761e-04  -1.72363660e-04
   4.18467108e-04  -1.65504167e-04   4.28911791e-04  -1.60034010e-04
   4.38733105e-04  -1.53470300e-04   4.47602132e-04  -1.47464472e-04
   4.56769124e-04  -1.41187411e-04   4.63460073e-04  -1.33361279e-04
   4.70209902e-04  -1.27266950e-04   4.76352327e-04  -1.19872600e-04
   4.81196159e-04  -1.13895236e-04   4.87773344e-04  -1.09467884e-04
   4.93298781e-04  -1.05209210e-04   4.99094056e-04  -1.03537052e-04
   5.05691266e-04  -1.01765925e-04   5.10195614e-04  -1.00463849e-04
   5.15115160e-04  -9.98751419e-05   5.18403946e-04  -9.81247606e-05
   5.19176948e-04  -9.73523076e-05   5.20585005e-04  -9.64001870e-05
   5.19033143e-04  -9.56880883e-05   5.18357158e-04  -9.72090950e-05
   5.17623123e-04  -9.88825958e-05   5.15805147e-04  -1.02908662e-04
   5.15675063e-04  -1.08569157e-04   5.14026579e-04  -1.13934620e-04
   5.11689415e-04  -1.21427363e-04   5.09226133e-04  -1.27494745e-04
   5.03681366e-04  -1.33699786e-04   4.98353817e-04  -1.40801379e-04
   4.90601384e-04  -1.46107474e-04   4.82496145e-04  -1.53774226e-04
   4.74886267e-04  -1.61925780e-04   4.66147986e-04  -1.70543133e-04
   4.59021220e-04  -1.82303343e-04   4.52310529e-04  -1.93091857e-04
   4.44548501e-04  -2.05286727e-04   4.38299537e-04  -2.17763227e-04
   4.29578999e-04  -2.27748783e-04   4.20652145e-04  -2.39121217e-04
   4.11349619e-04  -2.48056274e-04   4.00054873e-04  -2.56686489e-04
   3.90508302e-04  -2.66584829e-04   3.80309790e-04  -2.74928669e-04
   3.71472972e-04  -2.85228801e-04   3.65363692e-04  -2.95751280e-04
   3.58879103e-04  -3.05209687e-04   3.55033093e-04  -3.15937126e-04
   3.51244660e-04  -3.23415234e-04   3.46684753e-04  -3.30164191e-04
   3.44098290e-04  -3.34816766e-04   3.39808165e-04  -3.36093471e-04
   3.36628312e-04  -3.37968766e-04   3.35622709e-04  -3.36945677e-04
   3.34746273e-04  -3.35765635e-04   3.38506086e-04  -3.34853985e-04
   3.44097468e-04  -3.31552940e-04   3.51730199e-04  -3.28991797e-04
   3.63589828e-04  -3.23654175e-04   3.74545570e-04  -3.14872419e-04
   3.88603047e-04  -3.05256096e-04   4.02860009e-04  -2.89714834e-04
   4.17372043e-04  -2.72298817e-04   4.35893636e-04  -2.52473511e-04
   4.54270868e-04  -2.29274953e-04   4.76986750e-04  -2.06872065e-04
   5.04197870e-04  -1.81306020e-04   5.32794726e-04  -1.55020961e-04
   5.67607981e-04  -1.28287755e-04   6.03534744e-04  -9.61825028e-05
   6.41671799e-04  -6.33149769e-05   6.82770618e-04  -2.51727237e-05
   7.22422698e-04   1.71077839e-05   7.65691072e-04   6.08298984e-05
   8.10018529e-04   1.10200159e-04   8.55745181e-04   1.59101588e-04
   9.07413807e-04   2.09275738e-04   9.59933165e-04   2.61720729e-04
   1.01744704e-03   3.12158824e-04   1.07896556e-03   3.66477448e-04
   1.13996276e-03   4.22318466e-04   1.20522887e-03   4.78901652e-04
   1.26866063e-03   5.41931282e-04   1.33178768e-03   6.04651374e-04
   1.39706821e-03   6.71283067e-04   1.45947184e-03   7.39775575e-04
   1.52585521e-03   8.05165620e-04   1.59317094e-03   8.73100981e-04
   1.66100748e-03   9.36839576e-04   1.73393702e-03   9.99308058e-04
   1.80423349e-03   1.06304301e-03   1.87631495e-03   1.12267344e-03
   1.94722047e-03   1.18585538e-03   2.01189806e-03   1.24846753e-03
   2.07760458e-03   1.30991077e-03   2.13688620e-03   1.37421461e-03
   2.19362067e-03   1.43202611e-03   2.25107503e-03   1.48805288e-03
   2.30286433e-03   1.53969909e-03   2.35724679e-03   1.58222483e-03
   2.40864848e-03   1.62399948e-03   2.45535599e-03   1.65685752e-03
   2.50174947e-03   1.68640670e-03   2.53724450e-03   1.71517033e-03
   2.56776222e-03   1.73603603e-03   2.59123032e-03   1.75747382e-03
   2.60217371e-03   1.77163980e-03   2.61163551e-03   1.77725469e-03
   2.61070675e-03   1.77831394e-03   2.60499608e-03   1.76386437e-03
   2.59715912e-03   1.74178525e-03   2.57812988e-03   1.70965917e-03
   2.55669146e-03   1.66371702e-03   2.52380788e-03   1.61548174e-03
   2.47732565e-03   1.55476627e-03   2.42350873e-03   1.48799914e-03
   2.34987785e-03   1.41659582e-03   2.26759939e-03   1.32933472e-03
   2.17433702e-03   1.23634901e-03   2.06571145e-03   1.12654303e-03
   1.95568388e-03   9.99332229e-04   1.83109056e-03   8.62825116e-04
   1.69869756e-03   7.03957967e-04   1.55882921e-03   5.36359714e-04
   1.39831068e-03   3.58107315e-04   1.22923379e-03   1.63946721e-04
   1.03982588e-03  -3.14017281e-05   8.30494994e-04  -2.44015465e-04
   6.12510500e-04  -4.67240138e-04   3.71610071e-04  -7.00859616e-04
   1.24870469e-04  -9.60400480e-04  -1.31711762e-04  -1.23004169e-03
  -4.03763314e-04  -1.52207054e-03  -6.76627685e-04  -1.83426853e-03
  -9.69547763e-04  -2.15196502e-03  -1.27584645e-03  -2.49142772e-03
  -1.59426236e-03  -2.83325773e-03  -1.94205575e-03  -3.18292369e-03
  -2.29813368e-03  -3.55039977e-03  -2.67565181e-03  -3.91763364e-03
  -3.06973940e-03  -4.30972296e-03  -3.46230078e-03  -4.71713346e-03
  -3.87455389e-03  -5.13709967e-03  -4.28397880e-03  -5.58869323e-03
  -4.69991333e-03  -6.04271755e-03  -5.13548374e-03  -6.51429022e-03
  -5.56931107e-03  -6.99732625e-03  -6.03276136e-03  -7.47035404e-03
  -6.51067228e-03  -7.96200503e-03  -6.99685209e-03  -8.44705735e-03
  -7.51316587e-03  -8.93863621e-03  -8.01964676e-03  -9.45584089e-03
  -8.53676341e-03  -9.96891946e-03  -9.05721108e-03  -1.05163353e-02
  -9.55658669e-03  -1.10750906e-02  -1.00763089e-02  -1.16335971e-02
  -1.05852522e-02  -1.22184216e-02  -1.11016085e-02  -1.27773735e-02
  -1.16501284e-02  -1.33395273e-02  -1.21872968e-02  -1.39002966e-02
  -1.27599112e-02  -1.44304739e-02  -1.33335360e-02  -1.49909935e-02
  -1.38881613e-02  -1.55397474e-02  -1.44626302e-02  -1.61010563e-02
  -1.49872000e-02  -1.67055118e-02  -1.55073068e-02  -1.72846942e-02
  -1.60245436e-02  -1.79002339e-02  -1.65002642e-02  -1.85012130e-02
  -1.70257377e-02  -1.90570145e-02  -1.75365652e-02  -1.96328659e-02
  -1.80597414e-02  -2.01319063e-02  -1.86357062e-02  -2.06320381e-02
  -1.91501396e-02  -2.11477709e-02  -1.96932252e-02  -2.16145385e-02
  -2.01893861e-02  -2.21794150e-02  -2.05903539e-02  -2.27294269e-02
  -2.10242657e-02  -2.32890093e-02  -2.13376167e-02  -2.39268147e-02
  -2.16711571e-02  -2.44263252e-02  -2.20687038e-02  -2.49556008e-02
  -2.23845122e-02  -2.54042177e-02  -2.28886716e-02  -2.56762749e-02
  -2.33406668e-02  -2.60901318e-02  -2.37250963e-02  -2.63421500e-02
  -2.42319535e-02  -2.67146541e-02  -2.43188680e-02  -2.74020836e-02
  -2.43804235e-02  -2.79300225e-02  -2.42594232e-02  -2.90458829e-02
  -2.35470605e-02  -3.00366712e-02  -2.35905771e-02  -3.03788438e-02
  -2.33455210e-02  -3.14548733e-02  -2.33150225e-02  -3.03340538e-02
  -2.61008591e-02  -2.90709706e-02  -2.30239724e-02  -4.10097848e-02
   1.46996931e-02   1.48932994e-01   1.31427540e-01   1.37805803e-01
   1.30173795e-01   1.40455855e-01   1.29642951e-01   1.38208910e-01
   1.32566315e-01   1.36017514e-01   1.33609688e-01   1.34989951e-01
   1.35260123e-01   1.32935520e-01   1.36728117e-01   1.32551218e-01
   1.36639186e-01   1.32288330e-01   1.37525052e-01   1.32059307e-01
   1.36134661e-01   1.35018065e-01   1.34530797e-01   1.31890129e-01
   1.46584808e-01   9.39753969e-02  -4.33249093e-02  -2.27195457e-02
  -3.20583359e-02  -2.16684480e-02  -3.43478644e-02  -2.11004938e-02
  -3.21474491e-02  -2.36212915e-02  -2.99241370e-02  -2.43675503e-02
  -2.90147075e-02  -2.50329617e-02  -2.76231204e-02  -2.55734196e-02
  -2.70805484e-02  -2.51498527e-02  -2.68788687e-02  -2.48831850e-02
  -2.64835698e-02  -2.44329903e-02  -2.63862597e-02  -2.38834623e-02
  -2.60219655e-02  -2.36249927e-02  -2.55529993e-02  -2.32423430e-02
  -2.51224794e-02  -2.29816529e-02  -2.44670934e-02  -2.27755132e-02
  -2.39081509e-02  -2.24184416e-02  -2.33494031e-02  -2.21200154e-02
  -2.27662393e-02  -2.16919126e-02  -2.23232712e-02  -2.11911249e-02
  -2.18260932e-02  -2.07179749e-02  -2.13622227e-02  -2.01492872e-02
  -2.09115059e-02  -1.96394797e-02  -2.03653712e-02  -1.91429261e-02
  -1.98440911e-02  -1.86275276e-02  -1.92632102e-02  -1.81904988e-02'''

# AM.R05CB.00.ENN | 2023-05-17T04:57:38.783000Z - 2023-05-17T04:57:44.783000Z | 100.0 Hz, 601 samples (masked)
enn_str = '''1.47006479e-02   1.48956411e-01   1.31431185e-01   1.37829420e-01
   1.30177553e-01   1.40479916e-01   1.29646961e-01   1.38233137e-01
   1.32570451e-01   1.36042137e-01   1.33613605e-01   1.35014971e-01
   1.35263891e-01   1.32960691e-01   1.36731750e-01   1.32576499e-01
   1.36642611e-01   1.32313509e-01   1.37528500e-01   1.32084035e-01
   1.36138136e-01   1.35042456e-01   1.34534028e-01   1.31914034e-01
   1.46588237e-01   9.39978077e-02  -4.33245950e-02  -2.26994470e-02
  -3.20585548e-02  -2.16483216e-02  -3.43489715e-02  -2.10807173e-02
  -3.21493330e-02  -2.36021001e-02  -2.99270880e-02  -2.43486727e-02
  -2.90182449e-02  -2.50147711e-02  -2.76276246e-02  -2.55563431e-02
  -2.70856547e-02  -2.51336078e-02  -2.68843557e-02  -2.48678632e-02
  -2.64895096e-02  -2.44187102e-02  -2.63930462e-02  -2.38700117e-02
  -2.60293465e-02  -2.36122989e-02  -2.55611170e-02  -2.32304833e-02
  -2.51320212e-02  -2.29704541e-02  -2.44778564e-02  -2.27647808e-02
  -2.39199434e-02  -2.24085306e-02  -2.33624786e-02  -2.21111966e-02
  -2.27800764e-02  -2.16840380e-02  -2.23376255e-02  -2.11844814e-02
  -2.18411694e-02  -2.07128461e-02  -2.13778718e-02  -2.01454610e-02
  -2.09275477e-02  -1.96362892e-02  -2.03823940e-02  -1.91402933e-02
  -1.98620986e-02  -1.86255906e-02  -1.92791469e-02  -1.81790861e-02
  -1.86670002e-02  -1.76864807e-02  -1.80910311e-02  -1.71937703e-02
  -1.74769949e-02  -1.66982616e-02  -1.69102014e-02  -1.61377131e-02
  -1.63596420e-02  -1.55940121e-02  -1.57955333e-02  -1.50206049e-02
  -1.52713834e-02  -1.44384315e-02  -1.47123669e-02  -1.38923039e-02
  -1.41500158e-02  -1.33288236e-02  -1.35887967e-02  -1.28001093e-02
  -1.29904293e-02  -1.22823904e-02  -1.24156361e-02  -1.17511658e-02
  -1.18338459e-02  -1.12438414e-02  -1.12583953e-02  -1.07107362e-02
  -1.07189584e-02  -1.01766944e-02  -1.01732700e-02  -9.64981650e-03
  -9.65554764e-03  -9.10525543e-03  -9.14630850e-03  -8.58840012e-03
  -8.62764717e-03  -8.07593903e-03  -8.12859062e-03  -7.57621694e-03
  -7.61501140e-03  -7.10822569e-03  -7.10866685e-03  -6.63729441e-03
  -6.61737794e-03  -6.18812446e-03  -6.12314812e-03  -5.74546699e-03
  -5.65999393e-03  -5.29727110e-03  -5.20829685e-03  -4.86819170e-03
  -4.77178271e-03  -4.43362823e-03  -4.36263009e-03  -4.01227443e-03
  -3.95298010e-03  -3.61143662e-03  -3.56192701e-03  -3.21565908e-03
  -3.17874066e-03  -2.85020856e-03  -2.79518311e-03  -2.49769036e-03
  -2.43276019e-03  -2.15879393e-03  -2.07311540e-03  -1.84277697e-03
  -1.73173342e-03  -1.52663322e-03  -1.41310081e-03  -1.22728006e-03
  -1.10413098e-03  -9.36644458e-04  -8.22488922e-04  -6.50062280e-04
  -5.53226890e-04  -3.85944020e-04  -2.95592261e-04  -1.29363437e-04
  -5.70737219e-05   1.07874682e-04   1.80229259e-04   3.22661819e-04
   4.01636735e-04   5.28642348e-04   6.12350723e-04   7.11127024e-04
   8.15429530e-04   8.84611596e-04   9.95782686e-04   1.04885308e-03
   1.16647411e-03   1.19732063e-03   1.31881313e-03   1.34393133e-03
   1.45165602e-03   1.47531225e-03   1.57780968e-03   1.59562444e-03
   1.68504307e-03   1.70700474e-03   1.78627808e-03   1.79762268e-03
   1.87997554e-03   1.87929228e-03   1.96027092e-03   1.94591293e-03
   2.03833754e-03   1.99793664e-03   2.10176464e-03   2.04619756e-03
   2.15419305e-03   2.08088371e-03   2.19868225e-03   2.11161818e-03
   2.22504794e-03   2.13739022e-03   2.24569054e-03   2.15133814e-03
   2.25497897e-03   2.16338994e-03   2.25454909e-03   2.16254917e-03
   2.25342131e-03   2.15305042e-03   2.24221295e-03   2.13705178e-03
   2.22941186e-03   2.10802511e-03   2.21242722e-03   2.07677173e-03
   2.18620095e-03   2.03862642e-03   2.15828557e-03   1.99531814e-03
   2.11993055e-03   1.95371580e-03   2.07564411e-03   1.90519955e-03
   2.02786854e-03   1.85645094e-03   1.97171933e-03   1.80518659e-03
   1.91651250e-03   1.74638528e-03   1.85828675e-03   1.68777736e-03
   1.79808541e-03   1.62136364e-03   1.74114868e-03   1.55279739e-03
   1.67949995e-03   1.48408686e-03   1.61857476e-03   1.41091146e-03
   1.55611884e-03   1.34156499e-03   1.48838203e-03   1.27193247e-03
   1.42220349e-03   1.20256971e-03   1.35221869e-03   1.13714871e-03
   1.28211888e-03   1.06859784e-03   1.21500176e-03   1.00173399e-03
   1.14627819e-03   9.34455655e-04   1.08335866e-03   8.64331455e-04
   1.02132308e-03   7.97960403e-04   9.60454211e-04   7.29813200e-04
   9.03825457e-04   6.64567470e-04   8.44867574e-04   6.03966695e-04
   7.88421491e-04   5.43573000e-04   7.32532554e-04   4.89501176e-04
   6.75878679e-04   4.37004682e-04   6.24399251e-04   3.85612933e-04
   5.73257221e-04   3.38951158e-04   5.25971260e-04   2.89944601e-04
   4.84073183e-04   2.44525189e-04   4.43022458e-04   2.00801883e-04
   4.07953254e-04   1.57909471e-04   3.73872025e-04   1.20289836e-04
   3.40932667e-04   8.44138140e-05   3.11683336e-04   5.30182988e-05
   2.81509953e-04   2.65934960e-05   2.54754867e-04   5.48499917e-07
   2.30501919e-04  -2.06861485e-05   2.07387508e-04  -4.11876021e-05
   1.90356103e-04  -6.07744121e-05   1.74492099e-04  -7.71134958e-05
   1.62538367e-04  -9.41806415e-05   1.54594885e-04  -1.07331793e-04
   1.46237550e-04  -1.18266656e-04   1.41367082e-04  -1.27686719e-04
   1.36622241e-04  -1.31701269e-04   1.32135235e-04  -1.35095004e-04
   1.30781224e-04  -1.35598446e-04   1.28934279e-04  -1.33889772e-04
   1.30379570e-04  -1.33516611e-04   1.33924149e-04  -1.30236553e-04
   1.38566453e-04  -1.27479268e-04   1.47305472e-04  -1.24769420e-04
   1.55320721e-04  -1.19413965e-04   1.64968374e-04  -1.14675257e-04
   1.75612187e-04  -1.07037532e-04   1.84331412e-04  -9.79254203e-05
   1.94669958e-04  -8.87717845e-05   2.04162883e-04  -7.67415204e-05
   2.13732707e-04  -6.64966438e-05   2.25537383e-04  -5.59158209e-05
   2.35963713e-04  -4.52631945e-05   2.48933542e-04  -3.69942094e-05
   2.62174663e-04  -2.75839347e-05   2.74637968e-04  -1.87507638e-05
   2.88297368e-04  -1.03354126e-05   2.99915750e-04  -1.07066364e-07
   3.10551476e-04   8.39921254e-06   3.21095393e-04   1.88198808e-05
   3.29058734e-04   2.85274305e-05   3.38159387e-04   3.61632578e-05
   3.46211883e-04   4.47686504e-05   3.54003012e-04   5.03025838e-05
   3.62901132e-04   5.50710812e-05   3.69793139e-04   5.93246676e-05
   3.77472917e-04   6.15426685e-05   3.83939187e-04   6.50113758e-05
   3.88329622e-04   6.71663028e-05   3.92672067e-04   6.87698954e-05
   3.94221404e-04   7.16304314e-05   3.95177683e-04   7.18570263e-05
   3.96018369e-04   7.24855081e-05   3.94679186e-04   7.14113632e-05
   3.94906063e-04   6.82325853e-05   3.93885244e-04   6.50943652e-05
   3.92171237e-04   5.95763634e-05   3.91279938e-04   5.39846340e-05
   3.87611096e-04   4.86549945e-05   3.84290167e-04   4.16014519e-05
   3.79122418e-04   3.59402644e-05   3.72292335e-04   2.94056591e-05
   3.65950938e-04   2.20520613e-05   3.57701389e-04   1.53655703e-05
   3.50395884e-04   6.11897012e-06   3.43068278e-04  -2.91712353e-06
   3.34622887e-04  -1.32394106e-05   3.27743153e-04  -2.44279274e-05
   3.19803915e-04  -3.45559082e-05   3.11198437e-04  -4.62708938e-05
   3.02943362e-04  -5.66662729e-05   2.92573052e-04  -6.67580694e-05
   2.82909935e-04  -7.74391935e-05   2.72976132e-04  -8.67060037e-05
   2.61890412e-04  -9.71192942e-05   2.52802380e-04  -1.07850321e-04
   2.42843754e-04  -1.17943749e-04   2.34314175e-04  -1.29746396e-04
   2.26164548e-04  -1.40179503e-04   2.17716585e-04  -1.50833735e-04
   2.10240010e-04  -1.61555620e-04   2.01901000e-04  -1.70149170e-04
   1.93594577e-04  -1.79423990e-04   1.85969019e-04  -1.87152837e-04
   1.77375890e-04  -1.94378321e-04   1.70445144e-04  -2.02048631e-04
   1.63678843e-04  -2.08740740e-04   1.57187077e-04  -2.16231104e-04
   1.52933681e-04  -2.23260325e-04   1.47988250e-04  -2.29321323e-04
   1.44464253e-04  -2.35967637e-04   1.41474132e-04  -2.40669283e-04
   1.37683303e-04  -2.44955077e-04   1.35306688e-04  -2.48797893e-04
   1.31829305e-04  -2.51040246e-04   1.29286244e-04  -2.53530412e-04
   1.27865526e-04  -2.55228586e-04   1.26106942e-04  -2.56393767e-04
   1.26233076e-04  -2.58422583e-04   1.26823396e-04  -2.59042921e-04
   1.27449591e-04  -2.60379718e-04   1.29808663e-04  -2.61048308e-04
   1.31103079e-04  -2.60345682e-04   1.33380854e-04  -2.60013347e-04
   1.35518172e-04  -2.57950573e-04   1.37235922e-04  -2.55998829e-04
   1.39728973e-04  -2.53881915e-04   1.42184120e-04  -2.50702064e-04
   1.45207440e-04  -2.48637560e-04   1.49376791e-04  -2.45945182e-04
   1.52904577e-04  -2.43353307e-04   1.57775821e-04  -2.41448961e-04
   1.62434785e-04  -2.38286869e-04   1.66975234e-04  -2.35853341e-04
   1.71867712e-04  -2.32459010e-04   1.75374789e-04  -2.28691756e-04
   1.79774950e-04  -2.25359255e-04   1.83726902e-04  -2.20954795e-04
   1.87016377e-04  -2.17597053e-04   1.91508642e-04  -2.14793322e-04
   1.95141584e-04  -2.11321400e-04   1.99494921e-04  -2.09416521e-04
   2.04227445e-04  -2.07048977e-04   2.07790402e-04  -2.04809519e-04
   2.12096848e-04  -2.03335074e-04   2.15299605e-04  -2.00731269e-04
   2.17842575e-04  -1.98990014e-04   2.20783718e-04  -1.96952536e-04
   2.22117960e-04  -1.94888715e-04   2.24174580e-04  -1.94046012e-04
   2.25854797e-04  -1.92820102e-04   2.26922589e-04  -1.92642887e-04
   2.29213617e-04  -1.93003067e-04   2.30286734e-04  -1.93525218e-04
   2.31274412e-04  -1.94680906e-04   2.32527872e-04  -1.95696606e-04
   2.32109998e-04  -1.96663409e-04   2.32028299e-04  -1.98314168e-04
   2.30764546e-04  -1.99271160e-04   2.29266732e-04  -2.01165671e-04
   2.28265559e-04  -2.03162016e-04   2.25915552e-04  -2.05202702e-04
   2.24504783e-04  -2.08879968e-04   2.22953974e-04  -2.11803714e-04
   2.20716639e-04  -2.15944246e-04   2.19217485e-04  -2.19992951e-04
   2.16714489e-04  -2.23358134e-04   2.14095717e-04  -2.27662818e-04
   2.11560788e-04  -2.30980225e-04   2.07346149e-04  -2.34450170e-04
   2.04262737e-04  -2.38531889e-04   2.00310252e-04  -2.41729089e-04
   1.96341744e-04  -2.45719357e-04   1.92875545e-04  -2.49739675e-04
   1.89373903e-04  -2.54860700e-04   1.78262764e-04  -2.88875465e-04
   1.78639327e-04  -2.85555634e-04   1.41922855e-04  -3.16296956e-04
   1.69244998e-04  -2.29929275e-04   2.01501946e-04  -2.42987565e-04
   2.14868830e-04  -2.64131274e-04   1.71233253e-04  -2.84413022e-04
   1.67004392e-04  -2.87650815e-04   1.64418509e-04  -2.90591144e-04
   1.61786597e-04  -2.93421761e-04   1.60045768e-04  -2.96690327e-04
   1.58901547e-04'''

# AM.R05CB.00.ENZ | 2023-05-17T04:57:38.783000Z - 2023-05-17T04:57:44.533000Z | 100.0 Hz, 576 samples (masked)
enz_str = '''3.71322480e-04  -2.85496163e-04   3.65456726e-04  -2.95670628e-04
   3.58834949e-04  -3.05360972e-04   3.54874552e-04  -3.16072482e-04
   3.51341959e-04  -3.23433896e-04   3.46702897e-04  -3.30038569e-04
   3.44144884e-04  -3.34981758e-04   3.39653558e-04  -3.36201776e-04
   3.36594364e-04  -3.38061474e-04   3.35532863e-04  -3.37123238e-04
   3.34711352e-04  -3.35574160e-04   3.38752720e-04  -3.34993021e-04
   3.44020888e-04  -3.31437713e-04   3.51973514e-04  -3.29042736e-04
   3.63483326e-04  -3.23699946e-04   3.74581690e-04  -3.14933769e-04
   3.88642542e-04  -3.05117607e-04   4.03065561e-04  -2.89581389e-04
   4.17410621e-04  -2.72415075e-04   4.35798420e-04  -2.52638925e-04
   4.54307066e-04  -2.29202603e-04   4.77043765e-04  -2.06901282e-04
   5.04274341e-04  -1.81334517e-04   5.32872065e-04  -1.54999779e-04
   5.67747806e-04  -1.28099636e-04   6.03697218e-04  -9.60833918e-05
   6.41709697e-04  -6.32329537e-05   6.82880229e-04  -2.53036868e-05
   7.22452094e-04   1.72848324e-05   7.65789925e-04   6.08050622e-05
   8.10198629e-04   1.10153868e-04   8.55619859e-04   1.59019114e-04
   9.07316898e-04   2.08909906e-04   9.59705879e-04   2.61697604e-04
   1.01754150e-03   3.12140125e-04   1.07894853e-03   3.66467954e-04
   1.13994144e-03   4.22147363e-04   1.20534504e-03   4.78894084e-04
   1.26864044e-03   5.41962432e-04   1.33189730e-03   6.04701906e-04
   1.39712520e-03   6.71215684e-04   1.45945788e-03   7.39703009e-04
   1.52582854e-03   8.05098087e-04   1.59303639e-03   8.73050467e-04
   1.66087489e-03   9.36863261e-04   1.73407582e-03   9.99207401e-04
   1.80424488e-03   1.06282129e-03   1.87620501e-03   1.12249288e-03
   1.94708711e-03   1.18587287e-03   2.01219858e-03   1.24866568e-03
   2.07768742e-03   1.30998531e-03   2.13691846e-03   1.37407008e-03
   2.19371787e-03   1.43199340e-03   2.25113776e-03   1.48815986e-03
   2.30292931e-03   1.53981581e-03   2.35737506e-03   1.58230098e-03
   2.40883644e-03   1.62390611e-03   2.45535776e-03   1.65687515e-03
   2.50178438e-03   1.68635163e-03   2.53730303e-03   1.71524793e-03
   2.56783199e-03   1.73597818e-03   2.59105097e-03   1.75736315e-03
   2.60230571e-03   1.77167753e-03   2.61154677e-03   1.77706787e-03
   2.61067820e-03   1.77830979e-03   2.60505010e-03   1.76389827e-03
   2.59731403e-03   1.74168190e-03   2.57811839e-03   1.70967779e-03
   2.55684490e-03   1.66369346e-03   2.52372294e-03   1.61525709e-03
   2.47719770e-03   1.55471657e-03   2.42335976e-03   1.48782256e-03
   2.35000313e-03   1.41665687e-03   2.26768017e-03   1.32932288e-03
   2.17421189e-03   1.23619740e-03   2.06586606e-03   1.12657888e-03
   1.95565551e-03   9.99451245e-04   1.83132823e-03   8.62854585e-04
   1.69871077e-03   7.03986546e-04   1.55906224e-03   5.36485563e-04
   1.39827604e-03   3.57949502e-04   1.22930310e-03   1.63896649e-04
   1.03982242e-03  -3.14901941e-05   8.30607056e-04  -2.43979886e-04
   6.12381458e-04  -4.67308154e-04   3.71783319e-04  -7.00848458e-04
   1.24627721e-04  -9.60425633e-04  -1.31499638e-04  -1.23012435e-03
  -4.03990115e-04  -1.52230750e-03  -6.76541673e-04  -1.83433884e-03
  -9.69600740e-04  -2.15193656e-03  -1.27584705e-03  -2.49144859e-03
  -1.59403096e-03  -2.83332107e-03  -1.94208878e-03  -3.18303448e-03
  -2.29803768e-03  -3.55019789e-03  -2.67548546e-03  -3.91748294e-03
  -3.06948241e-03  -4.30959956e-03  -3.46215739e-03  -4.71714083e-03
  -3.87443613e-03  -5.13703113e-03  -4.28405609e-03  -5.58872170e-03
  -4.69969553e-03  -6.04257953e-03  -5.13542063e-03  -6.51448327e-03
  -5.56946241e-03  -6.99750177e-03  -6.03270612e-03  -7.47021991e-03
  -6.51067500e-03  -7.96225771e-03  -6.99684188e-03  -8.44708505e-03
  -7.51300091e-03  -8.93860873e-03  -8.01968380e-03  -9.45578761e-03
  -8.53668502e-03  -9.96915307e-03  -9.05734457e-03  -1.05163178e-02
  -9.55652564e-03  -1.10752436e-02  -1.00764659e-02  -1.16336056e-02
  -1.05850958e-02  -1.22184921e-02  -1.11016977e-02  -1.27774598e-02
  -1.16499409e-02  -1.33395065e-02  -1.21872787e-02  -1.39003266e-02
  -1.27597886e-02  -1.44303779e-02  -1.33333810e-02  -1.49910091e-02
  -1.38882214e-02  -1.55398410e-02  -1.44627322e-02  -1.61013272e-02
  -1.49871434e-02  -1.67054358e-02  -1.55071242e-02  -1.72846472e-02
  -1.60247229e-02  -1.79004201e-02  -1.65002525e-02  -1.85011902e-02
  -1.70256214e-02  -1.90570382e-02  -1.75364270e-02  -1.96330098e-02
  -1.80597692e-02  -2.01320293e-02  -1.86359253e-02  -2.06320416e-02
  -1.91498081e-02  -2.11477963e-02  -1.96932691e-02  -2.16146856e-02
  -2.01894775e-02  -2.21794017e-02  -2.05902676e-02  -2.27294779e-02
  -2.10239236e-02  -2.32887645e-02  -2.13376912e-02  -2.39269967e-02
  -2.16711609e-02  -2.44262483e-02  -2.20684714e-02  -2.49555600e-02
  -2.23843088e-02  -2.54042119e-02  -2.28886450e-02  -2.56763013e-02
  -2.33406204e-02  -2.60903862e-02  -2.37253899e-02  -2.63422936e-02
  -2.42318323e-02  -2.67147584e-02  -2.43188606e-02  -2.74022266e-02
  -2.43804770e-02  -2.79300580e-02  -2.42593485e-02  -2.90459077e-02
  -2.35470869e-02  -3.00369182e-02  -2.35906809e-02  -3.03792035e-02
  -2.33456595e-02  -3.14550332e-02  -2.33151037e-02  -3.03340902e-02
  -2.61008458e-02  -2.90712606e-02  -2.30239822e-02  -4.10098784e-02
   1.46995670e-02   1.48932983e-01   1.31427610e-01   1.37805779e-01
   1.30173853e-01   1.40455834e-01   1.29643011e-01   1.38208879e-01
   1.32566378e-01   1.36017478e-01   1.33609750e-01   1.34989908e-01
   1.35260189e-01   1.32935469e-01   1.36728187e-01   1.32551159e-01
   1.36639257e-01   1.32288265e-01   1.37525125e-01   1.32059233e-01
   1.36134735e-01   1.35017993e-01   1.34530862e-01   1.31890048e-01
   1.46584911e-01   9.39751902e-02  -4.33251844e-02  -2.27195600e-02
  -3.20582432e-02  -2.16685064e-02  -3.43477601e-02  -2.11007107e-02
  -3.21476357e-02  -2.36215458e-02  -2.99243441e-02  -2.43679430e-02
  -2.90148763e-02  -2.50333305e-02  -2.76233014e-02  -2.55738455e-02
  -2.70807578e-02  -2.51500984e-02  -2.68788688e-02  -2.48833476e-02
  -2.64834946e-02  -2.44332543e-02  -2.63863103e-02  -2.38836688e-02
  -2.60221153e-02  -2.36252861e-02  -2.55528691e-02  -2.32425013e-02
  -2.51225524e-02  -2.29819373e-02  -2.44670977e-02  -2.27755079e-02
  -2.39079303e-02  -2.24186154e-02  -2.33495176e-02  -2.21203629e-02
  -2.27662002e-02  -2.16922685e-02  -2.23229723e-02  -2.11915601e-02
  -2.18257884e-02  -2.07184138e-02  -2.13617338e-02  -2.01502069e-02
  -2.09108677e-02  -1.96399174e-02  -2.03648476e-02  -1.91433127e-02
  -1.98434806e-02  -1.86280648e-02  -1.92598021e-02  -1.81810234e-02
  -1.86462947e-02  -1.76880205e-02  -1.80697648e-02  -1.71949685e-02
  -1.74548965e-02  -1.66987838e-02  -1.68875173e-02  -1.61375255e-02
  -1.63365311e-02  -1.55932458e-02  -1.57724403e-02  -1.50190241e-02
  -1.52479831e-02  -1.44363590e-02  -1.46889891e-02  -1.38899274e-02
  -1.41263151e-02  -1.33262791e-02  -1.35646191e-02  -1.27977356e-02
  -1.29659296e-02  -1.22799952e-02  -1.23908988e-02  -1.17491703e-02
  -1.18087058e-02  -1.12421359e-02  -1.12333782e-02  -1.07089225e-02
  -1.06939972e-02  -1.01750690e-02  -1.01489103e-02  -9.64824646e-03
  -9.63164560e-03  -9.10368023e-03  -9.12317999e-03  -8.58694961e-03
  -8.60490490e-03  -8.07500287e-03  -8.10640231e-03  -7.57600227e-03
  -7.59307855e-03  -7.10864798e-03  -7.08699767e-03  -6.63866842e-03
  -6.59606944e-03  -6.19036827e-03  -6.10224902e-03  -5.74873893e-03
  -5.63998874e-03  -5.30130915e-03  -5.18920081e-03  -4.87270091e-03
  -4.75353977e-03  -4.43875734e-03  -4.34569681e-03  -4.01827474e-03
  -3.93731519e-03  -3.61804084e-03  -3.54730164e-03  -3.22330523e-03
  -3.16499584e-03  -2.85900578e-03  -2.78216306e-03  -2.50782912e-03
  -2.42045527e-03  -2.17027837e-03  -2.06162184e-03  -1.85541078e-03
  -1.72098768e-03  -1.54051630e-03  -1.40343925e-03  -1.24204907e-03
  -1.09555759e-03  -9.52359611e-04  -8.15560663e-04  -6.66513595e-04
  -5.47340111e-04  -4.03239345e-04  -2.90955510e-04  -1.47468598e-04
  -5.35759310e-05   8.85653048e-05   1.82967804e-04   3.02552488e-04
   4.03631832e-04   5.07151588e-04   6.13801682e-04   6.88609196e-04
   8.16294533e-04   8.61070042e-04   9.96247724e-04   1.02442757e-03
   1.16623968e-03   1.17236190e-03   1.31756546e-03   1.31865175e-03
   1.44986228e-03   1.44974929e-03   1.57491574e-03   1.56973508e-03
   1.68165832e-03   1.68092151e-03   1.78245146e-03   1.77096659e-03
   1.87602415e-03   1.85234637e-03   1.95631221e-03   1.91835600e-03
   2.03448435e-03   1.97011299e-03   2.09818486e-03   2.01808865e-03
   2.15079059e-03   2.05248178e-03   2.19515928e-03   2.08367975e-03
   2.22160847e-03   2.10973302e-03   2.24217506e-03   2.12443563e-03
   2.25153311e-03   2.13703467e-03   2.25130382e-03   2.13666478e-03
   2.25058354e-03   2.12745290e-03   2.24005331e-03   2.11199675e-03
   2.22811116e-03   2.08321950e-03   2.21234794e-03   2.05228206e-03
   2.18695999e-03   2.01487452e-03   2.16003548e-03   1.97221207e-03
   2.12247200e-03   1.93164864e-03   2.07866642e-03   1.88423845e-03
   2.03205841e-03   1.83711684e-03   1.97585793e-03   1.78693810e-03
   1.92253149e-03   1.72938127e-03   1.86463807e-03   1.67163436e-03
   1.80629235e-03   1.60610145e-03   1.75022606e-03   1.53820322e-03
   1.69019933e-03   1.47013601e-03   1.63063471e-03   1.39819465e-03
   1.56952477e-03   1.32984118e-03   1.50285687e-03   1.26181967e-03
   1.43765680e-03   1.19374342e-03   1.36838517e-03   1.12967789e-03
   1.29905899e-03   1.06239024e-03   1.23297497e-03   9.96589168e-04
   1.16519439e-03   9.30294185e-04   1.10359793e-03   8.60908998e-04
   1.04284892e-03   7.94826107e-04   9.83132058e-04   7.27448350e-04
   9.27685188e-04   6.62803781e-04   8.69456376e-04   6.02905245e-04
   8.13394646e-04   5.43410384e-04   7.58350052e-04   4.90240445e-04
   7.01705937e-04   4.38599765e-04   6.50356078e-04   3.87891178e-04
   5.99553546e-04   3.41278183e-04   5.52683915e-04   2.92418695e-04
   5.11303642e-04   2.46791805e-04   4.70912516e-04   2.02661454e-04
   4.36265416e-04   1.61321337e-04   4.01858498e-04   1.22109425e-04'''


np_data = {
  'ENE': ene_str,
  'ENN': enn_str,
  'ENZ': enz_str,
}

stream = [
  ['EHZ', 1684291035.313, 478406, 93276, 293724, 51653, 138622, 15407, 15178, -31014, -74374, -85504, -133682, -139356, -175930, -186945, -211692, -224979, -240612, -252791, -263164, -273019, -281533, -287876, -293554, -298624, -301442],
  ['ENN', 1684291035.313, -278104, -445287, -489067, -502289, -487139, -500876, -488428, -501749, -493884, -497647, -494357, -492132, -493823, -495797, -492239, -494641, -496915, -495805, -495060, -494764, -495687, -497559, -496481, -493395, -493205],
  ['ENZ', 1684291035.313, 3390879, 3459204, 3451986, 3420112, 3472224, 3413988, 3466424, 3421814, 3455059, 3434320, 3447924, 3440650, 3443303, 3442080, 3443664, 3442998, 3440775, 3441493, 3441334, 3442053, 3442564, 3441176, 3440477, 3440582, 3443123],
  ['ENE', 1684291035.313, -144526, -494065, -277963, -367751, -330370, -328836, -353493, -323347, -354485, -327598, -344716, -328785, -339004, -334232, -337232, -337285, -339470, -336225, -338558, -337831, -336275, -338446, -337172, -337347, -334539]
]

def get_trace(chan):
  # found_channel = next((st for st in stream if chan in st), None)
  found_channel = next((st for st in stream if chan == st[0]), None)
  if not found_channel:
    return None

  # l = list(found_channel)
  l = found_channel
  # print(l)
  timestamp = l[1]
  # data = np.array(l[2:])
  data = np.fromstring(np_data[chan], dtype=float, sep=' ')

  # Create a new Trace object
  trace = obspy.Trace(data)

  print(timestamp)
  # Set the sample rate and start time
  trace.stats.sampling_rate = 100.0  # Set the sample rate to 100 Hz
  trace.stats.starttime = obspy.UTCDateTime(timestamp)  # Set the start time
  return trace

def get_disp(trace):
  # First integration to get velocity (where trace.data is acceleration data from our accelerometers)
  vel_data = np.cumsum(trace.data)
  # Second integration to get displacement
  disp_data = np.cumsum(vel_data)
  # re-assign to trace data
  trace.data = disp_data
  trace.detrend(type='linear')
  return trace

def get_max_data():
  channels = ['ENN', 'ENZ', 'ENE']
  for ch in channels:
    tr = get_trace(ch)
    tr_disp = get_disp(tr)
    pgd = max(abs(tr_disp.data))
    print('%s max disp: %f' % (ch, pgd))

get_max_data()