import obspy
import numpy as np

'''
TRIGGERED
2023-05-17 02:37:15 [Processor] Max PGA Values (Acceleration (m/s$^2$))
{
    "ENE": 0.011891705588669957,
    "ENN": 5657.48357826317,
    "ENZ": 5657.480782259755
}
2023-05-17 02:37:15 [Processor] Signal deconvolution set to DISP
2023-05-17 02:37:15 [Processor] Alert stream units are displacement (m)
2023-05-17 02:37:15 [Processor] Deconv Channel: DISP     Units: Displacement (m)
2023-05-17 02:37:15 [Processor] Max PGD Values (Displacement (m))
{
    "ENE": 4.06369070205492e-05,
    "ENN": 55.20254009397969,
    "ENZ": 55.2025469241524
}
{
    "floor_num": 8,
    "event_time": "2023-05-17T02:37:15.30Z",
    "axis_with_max_drift": "z",
    "acceleration": {
        "x": 0.011891705588669957,
        "y": 5657.48357826317,
        "z": 5657.480782259755
    },
    "displacement": {
        "x": 4.06369070205492e-05,
        "y": 55.20254009397969,
        "z": 55.2025469241524
    },
    "intensity": {
        "x": "I",
        "y": "X+",
        "z": "X+"
    },
    "drift": {
        "x": 0.0020318453510274597,
        "y": 2760.1270046989844,
        "z": 2760.12734620762
    },
    "over_drift_thresh": {
        "x": false,
        "y": true,
        "z": true
    }
}
'''

# AM.R05CB.00.ENE | 2023-05-17T04:57:38.783000Z - 2023-05-17T04:57:44.533000Z | 100.0 Hz, 576 samples (masked)
ene_str = '''5.52771366e-08  -1.97714703e-07  -6.55759237e-08   1.24845857e-07
   6.91739273e-08   2.97361044e-08   7.92196883e-08  -2.11548890e-08
  -1.79243192e-07  -1.82324643e-07   8.47230345e-08  -8.05694431e-09
  -1.44614471e-07   2.96063700e-08   1.06506389e-07  -8.08499830e-08
  -7.83998941e-08   5.75895081e-08  -4.86166656e-08   6.25935688e-08
   1.56906781e-07  -5.83785071e-09  -4.83217658e-08  -4.27347219e-08
   4.20877295e-08  -2.21882041e-08  -1.09947526e-07  -2.39884844e-08
   7.58347728e-08   4.18002453e-08  -2.08052314e-08  -8.30708596e-08
  -1.24253309e-07  -1.22180107e-08   6.40911025e-08  -1.87886291e-08
   4.80646757e-08   1.00287314e-07  -6.54868274e-08  -6.85769221e-08
  -4.62704508e-08  -1.10095887e-07  -9.15838166e-08   4.92915867e-08
   8.46476956e-08   1.13171472e-07   1.47067257e-08  -3.93450353e-08
  -2.84394272e-08  -1.22434073e-09   9.69446245e-08   7.73819704e-08
   2.48506395e-09   3.33816378e-08   1.27733800e-07   2.61655799e-08
  -6.39822723e-08  -1.29468929e-07   4.25180101e-08   8.84666563e-09
  -1.20970058e-07  -4.27340687e-08  -2.08330197e-08   2.45376695e-08
   8.15920267e-08   2.21219047e-07   1.00551914e-07  -3.48469296e-08
   4.70699517e-08   4.64201162e-08  -8.61304912e-09  -1.69646298e-07
  -2.02425956e-07  -5.66743162e-09   9.92004917e-08   4.26137728e-08
   1.19344331e-08   1.31440864e-07   7.91209403e-08  -9.53522521e-08
  -1.76641601e-08  -4.79762089e-08   3.29739431e-08   1.12879836e-07
   4.63742735e-08   3.58179073e-08   9.88193886e-08  -1.41846665e-09
  -1.23623087e-07   5.77053333e-08   1.76474468e-07   1.70568565e-07
  -3.41006609e-08  -1.47702592e-08   9.73500439e-08   5.86216409e-08
  -5.08496785e-08  -1.16242077e-07   7.96760065e-08   7.08111138e-08
   3.81469449e-09   4.69280558e-08   6.05888832e-08  -4.88645970e-08
   5.51918119e-08   1.19043274e-07   4.83150964e-08   7.83047626e-08
   1.29698656e-08  -2.28150589e-08  -3.51010954e-08   4.96174770e-08
  -7.80991259e-09  -3.19508269e-08  -8.24322978e-08   1.30064762e-08
   2.72914195e-08  -1.24799053e-07  -2.25778796e-08  -3.05148422e-08
   6.79208667e-08  -1.16495844e-07  -1.86361856e-07  -1.97057279e-08
  -9.80400831e-08  -2.08741510e-07  -7.62769109e-08   1.57032711e-07
   6.90520390e-08  -6.38010740e-08  -1.90743744e-07  -5.00150510e-08
   9.49392805e-09  -1.25968076e-07  -1.19055130e-07   4.43421104e-08
   1.10703288e-07   1.51923645e-08   3.24284179e-08   6.22494206e-08
   2.99623427e-08   4.30320969e-08  -2.52388758e-09  -3.75208669e-08
   4.52182703e-08   3.28924361e-08   1.08873852e-07  -1.92891610e-08
  -6.76123669e-08  -1.52038576e-10  -1.13307293e-08  -4.74350900e-08
  -1.53190373e-08  -3.42555446e-09  -6.01151666e-08  -7.36380716e-08
  -2.29635445e-07  -7.01902461e-10  -4.88737895e-08  -2.01672128e-07
   8.62948490e-09  -6.51187002e-08   1.20962421e-07   2.07142174e-07
  -6.16956521e-08  -1.41532747e-07  -1.07059515e-07   6.62525372e-08
   1.11122697e-07  -6.18044111e-08   8.49737101e-08   5.70273112e-08
  -8.17702198e-08   7.28707642e-08   1.37849806e-09   2.15280811e-08
   8.36996198e-08   1.72379551e-07   1.51732790e-08  -1.20770881e-07
   1.78426145e-08  -1.73456392e-07  -1.47721055e-07   8.00492404e-08
   1.15508725e-08  -5.91457158e-09   7.72762609e-08  -3.09177522e-08
  -6.95497503e-08  -9.09706294e-08  -2.30733490e-07  -1.96135364e-07
   7.39710016e-08   1.43500281e-07  -9.15737500e-09  -8.00836721e-08
   1.14782450e-07   1.65185146e-07   4.62840157e-09   3.06848002e-09
   9.57590785e-09  -7.45023678e-08  -9.14015511e-08   2.44643560e-08
   2.67900735e-08   4.55003175e-09  -8.03513764e-08  -7.49307662e-08
   1.27381638e-07   1.04188086e-08  -1.78368930e-07  -6.13867453e-08
   7.10624927e-08   8.79767784e-08   9.61603439e-08   2.24653884e-08
  -1.41167351e-07  -4.39262430e-08   4.05473119e-08  -1.08159945e-07
  -5.88087855e-08  -3.36522906e-09  -1.07849882e-07  -1.69318271e-07
  -3.27317442e-08   3.17119170e-08   5.36113282e-08   8.54838571e-08
  -6.99447149e-08  -1.46179276e-07  -3.65997422e-08   5.96135969e-08
   7.48355392e-08   6.72919076e-08   8.44696176e-08   2.59546848e-07
   6.35093596e-08  -1.38281025e-07  -6.58608472e-08  -1.33313101e-07
  -9.76647009e-08  -2.34431442e-08   5.32317254e-08  -1.23744633e-07
  -3.34114587e-08   5.25151327e-09   1.82472235e-08   2.45486241e-07
   2.28049447e-07   1.53879081e-07  -7.19971581e-08   6.39851778e-08
   2.09645694e-07   1.24360985e-08  -1.78176229e-07   6.18336461e-08
   5.23024333e-08  -5.97327594e-08   1.58845492e-08   2.78857913e-09
   5.08811798e-08  -2.89661213e-08   2.52504134e-08  -1.07059293e-07
  -5.61656765e-08  -9.80913153e-08   1.98473398e-08   1.65423723e-07
  -1.26301291e-08   5.08551867e-08   3.90237695e-08  -5.34366729e-08
  -9.24935025e-08   4.73579173e-08  -5.98234398e-09   8.09912132e-09
   1.75800480e-07   8.21188906e-08  -1.90397188e-08   9.92164288e-09
   1.16008354e-07  -3.97931774e-08   6.52794220e-08   1.79511980e-07
  -3.90149875e-08  -1.44503566e-07  -5.34814102e-08   1.58842356e-07
   1.17610408e-07   1.46714621e-07   3.66160160e-08   3.62987631e-08
   4.97159775e-08  -2.33445062e-07  -1.88763024e-07   1.90995828e-08
   2.40853305e-08  -3.43875297e-08  -1.53220927e-07  -1.44820587e-07
   1.23638094e-07   1.81225324e-07   1.40534696e-07   8.47735991e-08
  -2.17660029e-08   4.42512245e-08   1.39303451e-07  -6.31293907e-08
  -1.14204459e-07  -4.69386294e-08  -7.19795375e-08   1.03738243e-07
   1.12378696e-07   1.08931233e-07   1.28655626e-07   1.67904058e-07
   8.32223225e-09  -6.25251810e-08   1.71196731e-07   3.78128899e-08
   3.19567234e-08  -4.49245221e-08  -8.87653651e-08   6.04349368e-08
   6.08464584e-08  -4.63314498e-09  -1.42122695e-09   5.28360818e-09
  -1.31951790e-08   4.95057175e-08  -1.82809336e-08  -1.00492667e-07
  -1.43338443e-09   1.53897500e-07   5.92861533e-08  -2.89985751e-08
   3.88906318e-08  -6.59871289e-10  -3.75692670e-08  -4.13916700e-08
  -6.80747904e-08   4.41038242e-08   1.61834445e-07   5.53977242e-08
  -1.03048686e-07  -1.15853536e-07  -4.91493770e-08  -2.99307043e-08
  -1.18500601e-08  -8.30286269e-08  -7.22418796e-08  -4.98180872e-08
  -7.49650208e-08  -3.20440453e-08  -3.57732652e-10  -3.57400212e-08
  -2.02386782e-08   7.28814971e-09  -5.15105775e-08  -1.05977414e-07
  -2.18695223e-08   9.39482775e-08   7.25167185e-08   1.05742614e-07
   2.88171658e-08  -3.61323896e-08  -4.64888715e-08   9.10618257e-08
   1.27419994e-07   4.89570230e-09  -9.07291748e-08  -9.09010950e-08
   1.31169706e-08   1.19343990e-07   1.03866833e-07  -1.71612372e-07
  -2.24407023e-07  -9.55327924e-08   4.53505118e-08   6.56990569e-08
  -1.33299938e-07  -3.58915234e-08   2.30118236e-07   7.13227661e-08
  -1.07327555e-07  -5.43621581e-08  -1.85381829e-08  -1.04041795e-07
  -1.13531797e-07  -8.12772086e-08  -1.92058218e-08  -1.26408696e-08
  -6.49159522e-08  -2.50811418e-08  -7.43925602e-09   9.77170595e-08
   7.82854276e-08   1.11411833e-07   2.27584458e-08  -2.29062446e-07
  -1.30568642e-07   6.27089369e-08   1.65123127e-09  -1.09891604e-07
   5.27114027e-08   6.11047423e-08  -9.41300933e-08  -6.52162717e-08
  -4.73713722e-08  -1.21701007e-07   4.92214475e-08   2.20977049e-07
   1.70315661e-07   1.08024405e-07   1.04896038e-07   1.28497174e-07
   9.92918384e-08   7.10864758e-08  -1.76796914e-08   1.83740473e-08
   3.45037836e-08  -1.24074358e-07  -1.04191653e-07   4.22553590e-08
  -7.52043050e-08  -1.11549684e-07   6.34875569e-08   4.06651657e-08
   1.95282340e-08  -5.18059811e-08  -9.38181750e-08   1.26096999e-08
  -7.14296244e-08  -6.52096140e-08  -5.60377351e-08  -1.50361835e-07
  -9.97555413e-08   6.09686061e-08   1.68563839e-07  -4.10554403e-08
  -1.13968099e-08   1.63774644e-07   3.84208752e-08  -1.82674985e-09
   5.93793152e-08   1.25590768e-07  -5.44291654e-10  -1.25030949e-07
   1.94594248e-08   8.18925175e-08  -2.43124781e-08  -3.69401722e-08
   8.93292614e-08   1.56956711e-07   1.18717191e-07   4.29304161e-08
  -3.89312417e-08  -2.83341730e-08   5.02659820e-09  -6.53559405e-08
  -7.43095665e-08  -2.47120573e-07  -1.12938692e-07   3.27444687e-08
   6.88167418e-08   1.80569563e-07  -2.13662424e-07  -2.53005122e-07
   5.50828217e-09   4.29698485e-08   5.95538190e-08  -3.07928511e-08
  -3.31891019e-08  -1.46228268e-08  -1.99338081e-08   8.37502330e-08
   8.27673100e-08  -4.43518313e-08  -1.49225421e-07  -1.83286864e-07
  -1.42688416e-07   2.98770948e-08  -7.93832251e-08  -6.08298244e-08
   1.28174506e-07  -1.58461766e-08   4.72770675e-08   9.81877562e-08
   1.11815791e-07  -1.47306049e-07  -1.31941387e-07  -6.68391306e-08
  -1.40376615e-07   1.14366245e-08  -7.65816069e-08   9.83896582e-08
   3.50053588e-08  -1.49393981e-07  -1.11174374e-07  -6.47447127e-08
   4.02193125e-08   5.95224783e-08  -6.69565214e-08  -1.70776035e-07
  -1.19590279e-07  -4.40395303e-08  -2.13539180e-08  -1.15052265e-07
  -9.00152190e-08   5.31266415e-08   1.37910394e-07   7.13527452e-08
  -8.37719704e-08  -9.95643373e-08   8.19109034e-08   1.29858402e-07
   1.83274005e-08  -1.91432448e-08  -1.75878522e-08   1.61166412e-08
   1.29515959e-08   1.90743092e-07   1.25424029e-07  -1.10430604e-07
   1.27076985e-07   1.56429161e-07   1.59036921e-07   2.45614753e-07
   1.64119462e-07  -1.03104389e-08  -2.31279319e-08   6.81842533e-08
   4.72406185e-09   1.57383407e-08  -1.00620526e-07   7.31180876e-09
   2.99403843e-08  -3.07430749e-08  -4.01162684e-08  -1.22188652e-07
   1.44722834e-07   2.05552593e-07   1.87874676e-07   1.13986779e-07
   5.23761253e-08   4.47309810e-09  -2.09658889e-08   1.33779782e-08
   4.48380989e-08  -1.60053962e-08  -1.96721201e-08  -5.11033761e-08
  -1.54986249e-07   3.17055975e-08  -1.13588042e-09   4.19229009e-09
   6.89862847e-08   4.99840963e-08   3.06560237e-09   1.48902126e-08
   9.14254025e-08   4.55836386e-09  -5.46949399e-08  -3.83068410e-08
  -1.31047607e-07  -1.87677770e-07  -2.16792415e-09  -1.34642895e-08
  -8.49647347e-08  -1.49518304e-07  -1.47360445e-07  -7.74665385e-08
  -4.54271905e-08  -4.20545456e-08  -8.27926350e-09   7.31915575e-08'''

# AM.R05CB.00.ENN | 2023-05-17T04:57:38.783000Z - 2023-05-17T04:57:44.783000Z | 100.0 Hz, 601 samples (masked)
enn_str = '''-3.39595979e-08  -2.37924196e-07  -3.01594244e-08   8.25130638e-08
   4.31629390e-08  -1.31036389e-07  -7.32546320e-08  -2.87807629e-09
  -8.14556898e-08  -1.09942772e-07   9.48794377e-08   8.34645176e-08
  -7.25319174e-08   2.44370570e-08   7.88634277e-09  -1.50437575e-08
   4.43380918e-08  -9.81617123e-08  -2.36554119e-07  -6.15757334e-08
   8.58268017e-08  -1.38694544e-07  -1.40450473e-07   6.22212647e-08
   3.12281100e-08  -2.46873828e-08   4.21724846e-08   5.98925936e-08
   1.89822584e-08   7.70846495e-08   1.58466493e-08  -5.72841611e-08
  -7.94168238e-08  -6.97582746e-08  -4.45930643e-08  -3.99864273e-08
   2.38497258e-08  -3.12885869e-08  -4.24623953e-08  -1.29626046e-08
  -1.20094860e-08   6.12046663e-08   1.45087034e-08  -9.40040194e-08
  -4.56345494e-08  -4.19718276e-09   5.59234212e-09  -6.38165866e-08
  -1.63217938e-07  -4.20245920e-08  -4.43462976e-08  -1.09317018e-07
  -8.99027084e-09   1.19619198e-07   3.30518620e-08  -8.10005939e-08
   5.21533981e-09  -2.62791745e-08   8.90792443e-08   8.61689476e-08
   2.42024145e-08   4.01170766e-08   1.80421582e-08   3.98223082e-08
  -6.70335793e-08   1.05429278e-09   2.14872437e-07   1.25411231e-07
  -1.08736660e-07  -1.12255144e-08   4.66089004e-08  -6.55717805e-08
   3.48547736e-08  -1.90008025e-08  -4.16922257e-08   1.49910484e-07
   1.53854348e-07   1.07178712e-07   9.72036844e-08   7.86870252e-08
   7.32186860e-08  -2.32392305e-08   4.20686432e-08   1.12658581e-07
   3.52954918e-08   1.00261347e-07   1.66163779e-07   5.70869475e-08
   6.72747019e-09   5.18493126e-08   9.14358761e-08   7.14023255e-08
  -1.38675091e-08  -3.62431677e-08   4.70316869e-08   1.28325413e-07
  -2.21595274e-08  -1.32116075e-08   1.49681945e-07   4.51359225e-08
  -3.05298415e-08  -4.56498018e-08  -9.34211796e-09   1.23975381e-08
   3.82607390e-08   8.13748154e-08   7.62819395e-08   6.48272116e-08
  -4.49810465e-08  -3.67454832e-08  -5.58255254e-08  -4.81067006e-08
  -6.90598632e-09  -5.37239476e-08  -6.42030550e-08  -2.46897460e-08
  -7.93894776e-08  -7.63103333e-08   1.87245974e-08  -4.16377727e-09
   3.07467654e-08  -8.89536575e-08  -1.40222538e-07  -3.05317531e-08
  -6.66989451e-08  -1.13751233e-07  -2.74502192e-08  -1.01694282e-07
  -2.94550263e-08  -3.46310026e-08  -1.36960878e-07   1.88852628e-08
  -1.27902991e-07  -2.99676393e-08  -3.16327527e-08  -1.07498661e-07
   9.11715831e-08   8.06364437e-08  -1.89962410e-08  -2.73718924e-08
   9.19448145e-08   5.72103021e-08  -1.21876374e-08   1.45394291e-08
   1.10037607e-08  -5.95934383e-08   4.23951828e-08   8.27319606e-08
  -8.14617493e-08  -7.18583434e-08   8.74975923e-08   7.56018742e-08
  -7.53260523e-08  -1.59786524e-07  -9.64349104e-08  -2.81358970e-08
  -1.59002609e-07  -2.83108677e-08   8.14716717e-08   1.47373610e-08
   1.17957834e-07   3.93135003e-08   7.90595437e-09   1.18619431e-07
   8.78051735e-08  -7.32644441e-08  -1.35827709e-07   4.32199954e-08
   1.21581156e-09  -1.67338214e-07  -1.32360682e-08   1.56130445e-08
  -7.06781905e-09   1.50569181e-08  -2.46728063e-08   3.31852125e-08
   3.52507259e-08  -2.09607683e-09  -4.79161792e-08  -6.95208347e-08
  -9.45871154e-08  -2.04240150e-07  -3.41254924e-08   6.89369616e-08
  -1.30601709e-07   2.80221723e-08   1.75658822e-07   1.26746207e-07
   8.75530269e-08  -4.41148633e-08  -1.10772715e-07  -2.10508301e-08
   8.18729731e-08   7.72571096e-08  -2.32128421e-08  -1.67897752e-07
  -4.96272356e-08   9.87084974e-08   9.31529255e-08  -3.14016960e-09
   8.17468871e-08   7.23600292e-08  -9.41693759e-08  -1.54971975e-08
  -6.55362326e-08  -6.93546399e-08  -3.33392642e-08  -8.52379314e-09
   8.22671196e-08   2.67756540e-08  -1.16297786e-07  -4.56274126e-08
   7.82202348e-08   6.98525652e-08   1.20175891e-07   8.14248511e-08
  -7.79281329e-08   3.94755241e-08   1.39651190e-07  -2.56299047e-08
  -8.29058803e-08  -9.06111844e-08  -6.67729449e-08  -5.60279646e-08
   4.85484920e-08   5.80917496e-08  -2.46161681e-08   5.43033937e-09
  -7.48716506e-08  -1.52354667e-07  -7.73231479e-08   6.76303705e-08
   1.68041100e-07   1.47779741e-07  -1.10222522e-08   5.66075476e-08
   1.80975188e-07   2.54065403e-08  -1.08727633e-07  -1.57316868e-07
  -8.67567490e-08   1.45702630e-07   1.04487569e-07  -1.16604153e-07
   4.04154943e-08   5.34616788e-08   6.71973072e-08   1.49469079e-07
  -2.04063838e-09  -7.55056768e-08  -1.35910824e-07   3.10010936e-08
   1.70827316e-07   4.65259997e-08  -1.12620504e-07  -3.25320411e-08
   7.91011044e-08   1.26260120e-07   7.64054484e-08   1.03938556e-08
   4.17204087e-08  -1.22808425e-08  -4.14318684e-08  -1.33503085e-07
  -1.24430349e-07  -2.29827856e-07  -1.80020720e-07   1.13910552e-07
   1.46963642e-07  -6.37727045e-09  -2.90958917e-08  -4.99517092e-08
  -1.37813767e-07   6.06446440e-08   1.57436463e-08   4.08340978e-08
   1.26544340e-07  -9.13657040e-08   9.61409331e-09   1.50367640e-07
   1.37583503e-07   8.72308548e-08   1.10725654e-07   1.40820600e-07
   2.95810327e-08  -1.65152160e-07  -1.08735115e-07   3.43546694e-08
   1.32548139e-07   2.08957921e-07   5.32077312e-08  -7.68784607e-10
  -7.75283870e-09  -7.90870239e-08  -1.14372527e-07   2.42639484e-08
   1.54814048e-08  -1.09715948e-07  -2.34649462e-08   1.49612456e-07
   2.01356318e-07  -4.22250189e-08  -3.47302684e-09   1.72864730e-07
   4.96841415e-08   9.68159983e-08   1.09983083e-07   3.84180195e-09
  -8.45426253e-09  -2.88833486e-11  -4.95855255e-08   1.54672391e-08
   3.57526720e-08   7.25068369e-08   8.89524109e-08   4.73201052e-08
  -5.13443822e-08  -1.31527557e-07  -2.64925850e-08  -1.60935902e-08
   3.34746108e-08  -1.44692123e-07   1.12933849e-09   1.25105234e-07
   3.48610419e-08   9.96897809e-09  -3.25600141e-08   1.11262406e-07
   8.09182995e-08  -6.46059938e-08  -1.12384928e-07  -1.97672330e-08
   5.20372975e-08   1.18333208e-07   1.96283321e-09  -1.05460176e-07
  -7.76621258e-08   2.56965874e-09  -9.50736455e-09  -1.32948263e-07
  -3.15296498e-08   1.58930073e-07  -1.38606156e-08  -2.27990224e-07
  -6.56763370e-08  -1.08119810e-07  -6.27978204e-08   9.95411231e-08
   1.13314619e-07  -1.18156081e-07  -2.00845935e-07  -6.59904070e-08
  -1.08994732e-07  -2.44720219e-07  -2.22763915e-07   1.66962782e-08
  -8.94583071e-08  -5.44463920e-08  -3.56034748e-08  -2.15115467e-07
  -6.61282229e-08   1.00075393e-07   2.16674076e-07   8.06366304e-08
  -6.58103725e-08   8.03872479e-08   3.11742408e-09  -7.84694588e-08
  -8.23660615e-08  -9.67327086e-08  -8.93704678e-08  -3.60051417e-08
   5.31046935e-08   1.50801767e-07   7.81764426e-08  -2.88873887e-08
  -4.19364168e-08   4.13267576e-08   1.64757337e-07   8.34610217e-08
   2.26124221e-08   3.89537724e-08   1.53467571e-07   3.25151054e-09
  -2.34312649e-07  -3.99083591e-08   1.66912116e-07  -4.73349229e-08
  -5.64213626e-08  -3.19569591e-08  -9.05359440e-09   3.61180316e-08
  -1.49085771e-07   4.71410969e-08   3.99719797e-08   9.62570416e-08
   1.84612034e-07   1.10198603e-07   1.31732696e-07  -2.16729477e-07
  -2.29696162e-07   3.41054575e-08   1.71478928e-08  -1.50558342e-08
   8.91267669e-08   1.50065655e-08  -1.39780193e-07  -2.34630285e-08
  -2.73151775e-09  -2.87092845e-08   8.43239574e-08   3.25306925e-08
  -8.24618816e-09  -6.29425264e-08   1.47264032e-08   9.55313052e-08
   6.97464500e-09   4.22754433e-08  -3.35586963e-08  -5.92935194e-08
  -9.21893488e-09   2.03852475e-08  -1.13193218e-07  -6.40417756e-08
   2.39266663e-08  -9.57575280e-08  -1.40901697e-08   8.80955086e-08
   2.72682083e-08  -8.56512941e-08  -2.15972632e-08   4.06811049e-08
   8.38464306e-09   1.06812312e-07   5.96072213e-08  -2.18383188e-07
  -6.38775101e-08   1.97711184e-07   1.10217007e-07  -1.50356602e-07
  -6.90569834e-08   3.26502319e-07   1.66937519e-07   1.00887350e-08
   6.73293041e-08   5.71384465e-08  -3.10943221e-08  -3.69204917e-08
   1.61718201e-08  -3.81843307e-09   1.49776759e-07   9.24785644e-09
  -4.91806177e-08   7.47889073e-08  -1.30021479e-08   3.22484163e-08
   4.65297539e-08   5.91438064e-08  -1.57691480e-08  -1.84236476e-07
  -1.09462424e-07  -9.17103559e-08  -6.39579155e-08   6.69201876e-09
   1.66767277e-07   1.11010544e-07  -1.51851368e-07  -3.05925747e-08
   1.20203892e-07   3.56153141e-08  -7.57898705e-08  -4.25534747e-08
  -1.17777983e-08   8.07504974e-11   2.20908347e-08   7.36445260e-08
   2.93617459e-08   1.92428500e-08  -3.36984676e-09  -1.82337947e-07
  -2.05530952e-07  -1.02832816e-07  -1.44905187e-07  -4.60236525e-08
   1.44768439e-07   2.92536567e-08   9.05626166e-08   1.84234796e-07
   9.03145458e-08  -1.86808840e-07  -1.46340004e-07  -6.37686218e-08
  -6.46172496e-08   1.69764414e-08  -1.67205069e-07  -1.13362427e-07
  -5.40760259e-09  -3.47006084e-08  -4.02384296e-08   7.84963817e-08
   1.15066412e-07   6.64114169e-08  -2.28726873e-08  -4.95527498e-08
  -5.71366219e-08  -1.10272233e-07  -4.71330578e-09   4.11187683e-08
   3.19365259e-08   8.41694290e-08   2.55683561e-07   1.54422543e-07
  -7.34382032e-08  -1.58162053e-07  -2.18467631e-07   1.73385487e-08
   1.07832649e-07  -2.42033530e-08  -2.47512939e-08   8.67040436e-08
   5.25704516e-08   1.58588350e-07   1.07600626e-07  -1.94670135e-07
  -8.16522267e-08   9.69687944e-08   1.41311979e-07   1.03680877e-07
   1.16120896e-07   7.03896552e-08  -6.84813512e-08  -1.45515663e-07
  -6.57265691e-08   3.46315561e-08  -3.35623501e-08   1.24004964e-08
  -8.06128499e-08  -8.91923384e-08   8.49059727e-08  -1.15965555e-07
  -7.24046626e-08   4.53667582e-08   2.66825614e-08   8.28195240e-08
   3.91828338e-08  -1.21270908e-07  -9.30110450e-08   1.16663724e-07
   1.68703943e-08  -1.37693755e-07  -3.08708091e-07  -3.96011556e-08
   1.34824199e-07   8.37333574e-08   5.91528423e-08  -3.17870009e-08
  -1.32679712e-08  -3.54166564e-08   5.04669686e-08   1.03758919e-07
   1.57362945e-07   2.42913725e-08   1.23176601e-08   1.12057278e-07
  -4.87937395e-08  -4.66462442e-08  -3.35211471e-08  -1.01133394e-07
   6.35742344e-08   7.48807278e-08  -1.50597156e-07  -1.21836446e-07
  -5.57278121e-08  -1.25160538e-07  -1.51656518e-07   7.16557063e-08
   1.43461371e-07  -9.76902530e-08  -4.92888175e-08   8.00903805e-08
   1.31937121e-07   3.79955575e-08  -2.64372468e-08   1.01226652e-07
   1.61891811e-07   8.36207947e-08  -3.65426829e-08   2.15650343e-08
   5.85385116e-08   9.68870399e-09  -6.65038726e-08  -1.76175815e-07
  -9.53826170e-08   1.45366162e-07   1.71939101e-07   1.01833858e-07
   8.91681950e-09   7.13972303e-08   7.75289514e-08   5.06895757e-08
   7.86154054e-08'''

# AM.R05CB.00.ENZ | 2023-05-17T04:57:38.783000Z - 2023-05-17T04:57:44.533000Z | 100.0 Hz, 576 samples (masked)
enz_str = '''-2.89877887e-08  -1.89057918e-08   4.75811758e-08   4.54396093e-08
  -1.40166035e-09   3.10189196e-08   2.99502539e-08  -3.46631528e-08
   5.86453077e-10  -5.25347581e-09  -6.82361075e-08  -1.60894296e-07
  -1.40962913e-07   3.42647689e-08   4.06996753e-08  -7.64240421e-08
  -5.34509265e-08   5.94736723e-08  -5.77126488e-08  -1.22827741e-07
   1.08215049e-08  -3.41408859e-08  -2.69434310e-08  -3.65096797e-08
  -4.57428279e-08  -1.79167019e-08  -3.14112889e-09   4.14268885e-08
  -1.91291307e-09  -7.21761003e-08  -5.57262351e-08   2.44757151e-08
  -2.29260526e-08  -4.11449398e-08  -7.90145649e-08  -1.27390906e-07
  -4.97312022e-08   9.70297598e-09  -1.19493073e-08  -6.31256719e-08
  -1.05359393e-07  -5.15553982e-08   2.88587705e-08  -3.58515907e-08
  -7.41292698e-08  -3.35764350e-08   5.50620907e-08   6.66468559e-08
  -2.36951463e-08   3.35555403e-08   4.10406661e-08  -4.45894830e-08
  -4.05022396e-08   3.32114384e-08   6.39633574e-08   1.06316218e-08
  -8.07716833e-11  -3.88264269e-08  -3.67546966e-08  -1.21613230e-08
  -1.00074556e-08   3.04063338e-08   8.41871498e-08   9.78043873e-08
  -2.86230574e-08   7.32622837e-09   1.13967117e-07  -4.24123732e-08
  -7.89538847e-08  -2.41228033e-09   1.72123547e-08   2.49511437e-08
  -3.82035785e-08  -1.02860321e-07  -9.13570300e-08  -1.42503470e-08
   4.39872054e-08   7.55973395e-08   9.33719041e-08   6.34464602e-08
   1.66564996e-08   2.78278704e-08   4.82614256e-08   4.30383638e-08
  -3.69983554e-09  -4.71059642e-08   4.26884179e-08   4.80729867e-08
   1.55193626e-08   5.64389447e-08   3.38966970e-08   1.73029344e-08
   5.47876288e-09   8.19198508e-09   5.63512924e-09   6.40698523e-08
   9.76315676e-08   5.12485604e-08   1.33442717e-07   9.51417781e-08
  -4.28941338e-08  -4.32891309e-08  -1.95227795e-08   3.69047621e-08
   3.55609292e-08  -6.77122620e-08  -4.57427401e-08  -1.32768233e-08
  -7.56049682e-08  -5.69440137e-08  -2.88942431e-08  -6.27222609e-08
  -6.63322969e-08  -6.15810664e-08  -1.01212121e-07  -2.85396904e-08
   4.87443601e-08   3.64359652e-09   2.13602260e-08   3.20776011e-08
   4.21511794e-08   6.95022493e-08   1.90012073e-09  -4.88635863e-08
  -7.27520710e-08  -1.37149355e-07  -3.23668820e-08   2.45824272e-08
  -4.46757011e-09  -1.52905702e-08  -3.69871770e-08   3.16741252e-08
  -2.67200307e-08   7.57496849e-08   1.04402124e-07  -2.35064880e-08
   6.86633998e-08   7.90893995e-08  -3.67576376e-08  -4.05225309e-08
   5.20830004e-08   6.73312834e-08   4.50461585e-08  -2.37169275e-08
  -1.15420591e-07  -9.12638706e-08   5.83693328e-08   6.44481467e-08
  -3.07437903e-08  -7.20761385e-08  -3.13663891e-09   3.98994100e-08
  -5.16671622e-08  -7.81865526e-08  -7.93518414e-08  -8.71899142e-08
  -1.41306703e-07  -6.38248377e-08   1.65824638e-08  -3.62963734e-08
  -3.96278232e-08  -5.52376881e-08   1.61274146e-08   2.46022244e-08
  -7.43007358e-08  -1.15782562e-08   1.52776325e-08   9.17886905e-09
   4.15535177e-08   9.15876945e-09   1.79374596e-08   4.83394487e-09
   3.77719853e-08   6.23280144e-08  -5.62572231e-09   2.05014482e-08
   1.02186828e-08   4.86734216e-08   3.46168995e-08  -8.04147834e-08
  -3.81879146e-08  -5.45647479e-08   7.90934105e-09   6.35825222e-08
  -3.87243323e-08  -2.06763091e-08   7.16796541e-08   2.64029175e-08
   5.78201825e-08   5.50473630e-08  -9.20326993e-09   2.87056215e-08
  -1.81455346e-08  -8.79240818e-09  -1.59311021e-08  -3.42414978e-08
  -1.47171916e-08  -5.37429619e-08  -2.77291445e-08   5.97665849e-08
   6.39803369e-08  -1.37469834e-08  -2.77086964e-08   4.14312147e-08
  -1.27098292e-08  -9.59592013e-08  -1.10294393e-07  -7.90117704e-08
   4.23370875e-08  -1.10681715e-08  -7.26596646e-08   8.79843662e-08
   5.51584503e-08  -1.91577970e-08   8.92200735e-08   5.20784239e-08
  -7.15759579e-08   3.41799498e-08   8.62352455e-08  -1.14366995e-07
  -6.32642957e-08   5.54220128e-08  -7.00576495e-08  -9.02619366e-08
   3.59941772e-08   1.49827951e-07   1.22926484e-07  -2.04248216e-09
  -2.49714709e-08  -4.21328940e-08  -1.85782022e-08   2.87313661e-08
   2.21582405e-08   2.76786513e-08   2.43189410e-08   5.11556600e-08
   5.46688870e-08  -5.98988247e-08  -1.07966469e-07  -6.08617408e-08
  -6.14111689e-08   2.69329609e-08   6.09709894e-09  -9.39307418e-08
  -1.20664102e-08   2.93353180e-08  -2.30450381e-09   1.16470874e-08
   2.11109731e-08   5.12562738e-09  -3.64777451e-08  -6.49599888e-09
   4.96517527e-08   1.65955171e-08  -1.72134392e-08  -2.20319750e-08
   2.61396360e-08   4.25871658e-08  -2.52796614e-08  -1.49553290e-08
   8.13158355e-08   9.05721114e-08   2.45578494e-08  -5.45698865e-08
  -5.36776504e-08  -2.43510962e-08   2.27836801e-08   5.53251880e-08
   2.06580585e-08  -1.98683750e-08  -3.22547152e-08  -3.10592052e-08
  -1.23570177e-08   5.91260351e-08  -5.99085406e-08  -7.03304241e-08
   6.16556087e-08  -2.36158438e-08  -7.02508337e-08  -9.55190087e-08
  -4.48832117e-08  -7.28041954e-09   2.87385247e-08   1.08396119e-07
   5.35459687e-08  -4.27851396e-08  -1.33465278e-08   5.50797625e-08
   4.49279441e-09   8.32638922e-08   7.19027421e-08   7.60433877e-08
   5.89018156e-08  -5.57389832e-08   3.44664914e-08   7.74073594e-09
  -5.51539270e-08  -3.08784609e-08  -6.60899195e-08  -2.18880881e-08
   3.41876663e-08  -5.73429263e-08   3.18960455e-08   1.01076323e-07
  -6.64004065e-08  -5.65629157e-08   3.49280482e-08   2.31165632e-08
  -1.14912301e-09   3.41156940e-08   1.21134742e-07   1.43377799e-07
   6.63281021e-08   9.70333496e-08   4.90440172e-08   6.43718460e-09
  -2.56900597e-08  -2.94545170e-08   5.05393932e-08   4.98242572e-08
   2.38620128e-08  -7.74023385e-08   4.80637635e-08   8.64457400e-08
   5.20402891e-08   6.70813899e-08   3.53334738e-08   3.22150865e-08
  -6.68090165e-09  -1.91743362e-09  -3.38423210e-09  -1.50876449e-08
  -2.53917419e-08  -5.50395205e-08  -5.41157447e-08  -8.13776935e-08
  -3.24162895e-08   4.27668581e-08  -3.73640423e-08  -1.03120587e-07
  -1.01075132e-07   3.05137573e-08  -6.81468673e-09  -6.73261162e-08
  -1.75012091e-08  -3.83604607e-08  -6.44564826e-08  -4.14297822e-08
   1.91955985e-08  -4.29548296e-09   6.82257243e-09   7.62504939e-10
  -3.36496301e-08  -6.43051181e-08  -1.71611045e-08   2.63988193e-08
  -6.72205499e-08  -8.70911914e-08   1.66561970e-08  -7.52371756e-08
  -4.26781523e-08   1.75778303e-08   4.70857975e-08   4.93852515e-08
  -5.53132605e-09   9.95224644e-08   5.62155694e-08   3.66997340e-08
  -1.47804072e-08   4.04500504e-08  -7.32927427e-09  -4.56378353e-08
   1.89948565e-08  -9.78279073e-08  -9.89688022e-08  -1.70219290e-08
  -1.52032375e-08  -3.88559263e-08   3.87498706e-08   8.46682285e-08
   3.87243442e-08   7.36945032e-08   8.78430035e-08  -9.09981310e-08
  -8.96198979e-08   4.24506497e-08   4.60353339e-08  -1.00849802e-08
   1.68190600e-08   5.35221884e-08   3.15862985e-08  -4.28320000e-08
  -7.35748978e-08   1.73911489e-09   1.47012634e-09   1.13661814e-07
   7.05711067e-08  -2.42789007e-08  -5.08380909e-08  -7.66749810e-08
  -6.67123425e-09  -3.99620315e-08  -5.44412895e-08  -1.18540159e-07
  -8.49491090e-08   1.58389706e-08   3.87383331e-08   6.05193038e-08
  -1.65300959e-08  -1.21282183e-07   2.17093745e-09   1.80999517e-08
  -5.81745380e-08   9.13024762e-09   5.76050817e-08   3.68716790e-08
  -2.14960001e-08   6.63315010e-08   5.10944953e-08   2.20900602e-08
   4.96900972e-08  -5.83063060e-08  -7.26403506e-08   4.77928621e-08
  -7.10506925e-09  -3.87241698e-08   1.53135256e-07   8.20032914e-08
  -4.73946504e-08  -5.04916686e-08  -4.70006120e-08   7.51480653e-08
   4.48079592e-08  -3.27345565e-08  -1.08014462e-07  -1.35361510e-07
  -2.55845567e-08   5.14464830e-08   4.61466965e-08  -7.57155791e-08
  -6.74425488e-08  -2.23491434e-08   1.96147904e-08   3.91510403e-08
   6.60166307e-08   7.68757312e-08  -5.24748662e-08   5.26462621e-09
   3.27725935e-08   3.33833119e-08   2.63413409e-08  -3.12100040e-08
   3.73216316e-08  -1.06235606e-08  -4.29047589e-09   1.09401110e-07
  -3.68916106e-09  -7.28651103e-08   3.80055227e-08   2.07382443e-08
  -8.74999783e-09  -7.27883118e-08  -3.95695254e-08  -3.30938581e-09
   4.89567391e-08   5.46323438e-08  -1.04034379e-07  -6.32747349e-08
   2.96316449e-08  -1.30842644e-08  -4.58334379e-09   4.26619884e-08
  -1.28261032e-08  -6.79792719e-08  -6.92907127e-08   8.80904391e-08
   4.44079400e-08  -8.29420375e-08  -3.11455531e-08  -5.51878995e-08
  -3.91526681e-08   2.40409144e-08  -2.38241220e-08   6.58581228e-08
   1.65536423e-07   5.79375257e-08   4.26341220e-08   3.87475548e-08
   7.18708450e-08  -5.63021576e-09   1.90204554e-08   4.17270210e-09
  -1.03751670e-07  -4.54187123e-08  -7.98476382e-08  -4.55934707e-08
   4.42182187e-08  -1.01015210e-08  -1.08051894e-07  -8.54431191e-08
   3.18543005e-08   8.29842686e-08  -9.21375770e-09   8.76162382e-09
  -3.95688938e-08  -6.23212704e-08  -1.59215940e-09   6.98824013e-10
   3.23849937e-08   1.41535867e-08   2.20997027e-08   6.06109121e-08
   2.70336568e-08   2.15733202e-08   4.24149094e-08   1.63623112e-08
   6.76990879e-09   7.70579761e-08   1.19756532e-07   2.90664988e-08
  -5.40659490e-09   2.83973379e-08   8.89070751e-08  -2.23820325e-08
  -9.19358185e-08   9.32530882e-09   1.44048788e-07   1.32001265e-07
   3.11876454e-08  -4.25810570e-08  -8.51536796e-08   1.53624040e-08
   2.28507059e-08   5.03995311e-08   4.13757239e-08   2.04270074e-08
   4.22367939e-08   8.31041342e-08   1.18655242e-07   1.23029470e-08
   3.76272195e-08   1.28677205e-07   8.79482140e-08  -1.59232907e-08
   4.51820794e-08   3.87001250e-08  -5.54650274e-08  -3.14047765e-08
  -2.03627937e-08  -1.51433280e-07  -2.68755257e-08   1.53481949e-07
   6.50588581e-08   5.15499026e-08  -5.18843485e-08  -2.46475349e-08
   6.30445411e-08  -2.30399447e-09  -4.58404830e-08   1.68085563e-09
   6.75407379e-08   9.77367954e-08   6.07262616e-08   1.47256657e-08
  -2.86631256e-09   8.27754499e-09   3.84613257e-08  -5.85855445e-09
  -1.68430292e-08  -4.34032255e-08  -2.81870116e-08   3.29119710e-08
   7.80800678e-08   1.73661296e-08  -4.78480589e-08  -2.44260609e-08'''


np_data = {
  'ENE': ene_str,
  'ENN': enn_str,
  'ENZ': enz_str,
}

stream = [
  ['EHZ', 1684291035.313, 478406, 93276, 293724, 51653, 138622, 15407, 15178, -31014, -74374, -85504, -133682, -139356, -175930, -186945, -211692, -224979, -240612, -252791, -263164, -273019, -281533, -287876, -293554, -298624, -301442],
  ['ENN', 1684291035.313, -278104, -445287, -489067, -502289, -487139, -500876, -488428, -501749, -493884, -497647, -494357, -492132, -493823, -495797, -492239, -494641, -496915, -495805, -495060, -494764, -495687, -497559, -496481, -493395, -493205],
  ['ENZ', 1684291035.313, 3390879, 3459204, 3451986, 3420112, 3472224, 3413988, 3466424, 3421814, 3455059, 3434320, 3447924, 3440650, 3443303, 3442080, 3443664, 3442998, 3440775, 3441493, 3441334, 3442053, 3442564, 3441176, 3440477, 3440582, 3443123],
  ['ENE', 1684291035.313, -144526, -494065, -277963, -367751, -330370, -328836, -353493, -323347, -354485, -327598, -344716, -328785, -339004, -334232, -337232, -337285, -339470, -336225, -338558, -337831, -336275, -338446, -337172, -337347, -334539]
]

def get_trace(chan):
  # found_channel = next((st for st in stream if chan in st), None)
  found_channel = next((st for st in stream if chan == st[0]), None)
  if not found_channel:
    return None

  # l = list(found_channel)
  l = found_channel
  # print(l)
  timestamp = l[1]
  # data = np.array(l[2:])
  data = np.fromstring(np_data[chan], dtype=float, sep='  ')

  # Create a new Trace object
  trace = obspy.Trace(data)

  print(timestamp)
  # Set the sample rate and start time
  trace.stats.sampling_rate = 100.0  # Set the sample rate to 100 Hz
  trace.stats.starttime = obspy.UTCDateTime(timestamp)  # Set the start time
  return trace

def get_disp(trace):
  # First integration to get velocity (where trace.data is acceleration data from our accelerometers)
  vel_data = np.cumsum(trace.data)
  # Second integration to get displacement
  disp_data = np.cumsum(vel_data)
  # re-assign to trace data
  trace.data = disp_data
  trace.detrend(type='linear')
  return trace

def get_max_data():
  channels = ['ENN', 'ENZ', 'ENE']
  for ch in channels:
    tr = get_trace(ch)
    tr_disp = get_disp(tr)
    pgd = max(abs(tr_disp.data))
    print('%s max disp: %f' % (ch, pgd))

get_max_data()